# resolved

from math import gcd
from Crypto.Util.number import bytes_to_long, getPrime, long_to_bytes, inverse
import gmpy2
from factordb.factordb import FactorDB


def egcd(e, phi):
    x, y, u, v = 0, 1, 1, 0
    while e != 0:
        q, r = phi // e, phi % e
        m, n = x - u * q, y - v * q
        phi, e, x, y, u, v = e, r, u, v, m, n
        gcd = phi
    return gcd, x, y


def attack(n, e, c):
    f = FactorDB(n)
    # f.connect()
    if '200' not in f.connect():
        exit
    p, q = f.get_factor_list()
    phi = (p - 1) * (q - 1)
    # ---------------------------
    # d = int(gmpy2.invert(e, phi))
    # plaintext = int(pow(c, d, n))
    # -----------or--------------
    gcd, a, b = egcd(e, phi)
    d = a  # or d = inverse(e, phi)
    plaintext = pow(c, a, n)
    # ---------------------------
    return [plaintext, p, q, d]


e = 65537
n = 15360430612195884668505674226320381918816025423409674792639378283651917493564662095392839462768570280688204963687867587119107450770617692216265741475101438908006141086639657319549195208471346757021503258405279036848538487620298374935971042386105752140990313817542782558218726126638092132813167983904390108008435327737975189710851416185214897318087233960475165126758817935351719601177948252794308918244726980044400917760281088072141936954809516779668499304057531735464446988261314507139561002499535818114960847038017448821042494772684216534039163581484460326934555526049210974762066564580982899537315296746870282829017
c = 1491256285226085686080611462534436394708242996098270582046567754972224965119033695760219715986423304961241507616485548629836330764574311108463787749157200309630204195118236839038863198705121448107995400351994929874239442260815545380843831260638279253970650134650588879470252350531416719849751458191011287820528294737197122284186820620482815046862426923319233325486987032280629228239872991776919866826115243577863684772467998968626705298310096374368417600077513507819307209464862337340524066758551533994058022549685305943809319129173122798255064046867622893134212025744669998037984544773340481660247657588558073081228

m = long_to_bytes((attack(n, e, c))[0])
print(m)